{
  "type": "excalidraw",
  "version": 2,
  "source": "https://excalidraw.com",
  "elements": [
    {
      "id": "outer-bg",
      "type": "rectangle",
      "x": 40,
      "y": 40,
      "width": 720,
      "height": 620,
      "strokeColor": "#1971c2",
      "backgroundColor": "#a5d8ff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 15,
      "roundness": { "type": 3 }
    },
    {
      "id": "title",
      "type": "text",
      "x": 200,
      "y": 60,
      "width": 400,
      "height": 32,
      "text": "分布式查询的 Snapshot 机制",
      "fontSize": 24,
      "fontFamily": 4,
      "textAlign": "center",
      "strokeColor": "#1971c2"
    },
    {
      "id": "coord-label",
      "type": "text",
      "x": 80,
      "y": 110,
      "width": 260,
      "height": 20,
      "text": "Coordinator Node（协调节点）",
      "fontSize": 14,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#1971c2"
    },
    {
      "id": "coord-box",
      "type": "rectangle",
      "x": 100,
      "y": 140,
      "width": 600,
      "height": 50,
      "strokeColor": "#1971c2",
      "backgroundColor": "#a5d8ff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 60,
      "roundness": { "type": 3 },
      "boundElements": [{ "id": "arr1", "type": "arrow" }, { "id": "arr2", "type": "arrow" }, { "id": "arr3", "type": "arrow" }]
    },
    {
      "id": "coord-text",
      "type": "text",
      "x": 120,
      "y": 153,
      "width": 560,
      "height": 24,
      "text": "发送查询到各个 Shard（每个 Shard 选择一个 Replica 执行）",
      "fontSize": 12,
      "fontFamily": 4,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard1-box",
      "type": "rectangle",
      "x": 80,
      "y": 260,
      "width": 180,
      "height": 220,
      "strokeColor": "#2f9e44",
      "backgroundColor": "#b2f2bb",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 50,
      "roundness": { "type": 3 },
      "boundElements": [{ "id": "arr1", "type": "arrow" }]
    },
    {
      "id": "shard1-title",
      "type": "text",
      "x": 130,
      "y": 270,
      "width": 80,
      "height": 20,
      "text": "Shard 1",
      "fontSize": 14,
      "fontFamily": 4,
      "textAlign": "center",
      "strokeColor": "#2f9e44"
    },
    {
      "id": "shard1-snap",
      "type": "text",
      "x": 110,
      "y": 295,
      "width": 120,
      "height": 18,
      "text": "Snapshot A",
      "fontSize": 12,
      "fontFamily": 4,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard1-ind",
      "type": "text",
      "x": 115,
      "y": 315,
      "width": 110,
      "height": 16,
      "text": "(独立创建)",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "center",
      "strokeColor": "#495057"
    },
    {
      "id": "shard1-parts",
      "type": "text",
      "x": 100,
      "y": 345,
      "width": 60,
      "height": 18,
      "text": "Parts:",
      "fontSize": 11,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard1-p1",
      "type": "text",
      "x": 110,
      "y": 365,
      "width": 80,
      "height": 16,
      "text": "• Part 1",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard1-p2",
      "type": "text",
      "x": 110,
      "y": 383,
      "width": 80,
      "height": 16,
      "text": "• Part 2",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard1-p3",
      "type": "text",
      "x": 110,
      "y": 401,
      "width": 80,
      "height": 16,
      "text": "• Part 3",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard1-diff",
      "type": "text",
      "x": 115,
      "y": 430,
      "width": 110,
      "height": 16,
      "text": "(数据不同)",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "center",
      "strokeColor": "#495057"
    },
    {
      "id": "shard2-box",
      "type": "rectangle",
      "x": 310,
      "y": 260,
      "width": 180,
      "height": 220,
      "strokeColor": "#e67700",
      "backgroundColor": "#fff3bf",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 50,
      "roundness": { "type": 3 },
      "boundElements": [{ "id": "arr2", "type": "arrow" }]
    },
    {
      "id": "shard2-title",
      "type": "text",
      "x": 360,
      "y": 270,
      "width": 80,
      "height": 20,
      "text": "Shard 2",
      "fontSize": 14,
      "fontFamily": 4,
      "textAlign": "center",
      "strokeColor": "#e67700"
    },
    {
      "id": "shard2-snap",
      "type": "text",
      "x": 340,
      "y": 295,
      "width": 120,
      "height": 18,
      "text": "Snapshot B",
      "fontSize": 12,
      "fontFamily": 4,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard2-ind",
      "type": "text",
      "x": 345,
      "y": 315,
      "width": 110,
      "height": 16,
      "text": "(独立创建)",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "center",
      "strokeColor": "#495057"
    },
    {
      "id": "shard2-parts",
      "type": "text",
      "x": 330,
      "y": 345,
      "width": 60,
      "height": 18,
      "text": "Parts:",
      "fontSize": 11,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard2-p1",
      "type": "text",
      "x": 340,
      "y": 365,
      "width": 80,
      "height": 16,
      "text": "• Part 4",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard2-p2",
      "type": "text",
      "x": 340,
      "y": 383,
      "width": 80,
      "height": 16,
      "text": "• Part 5",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard2-p3",
      "type": "text",
      "x": 340,
      "y": 401,
      "width": 80,
      "height": 16,
      "text": "• Part 6",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard2-diff",
      "type": "text",
      "x": 345,
      "y": 430,
      "width": 110,
      "height": 16,
      "text": "(数据不同)",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "center",
      "strokeColor": "#495057"
    },
    {
      "id": "shard3-box",
      "type": "rectangle",
      "x": 540,
      "y": 260,
      "width": 180,
      "height": 220,
      "strokeColor": "#7048e8",
      "backgroundColor": "#d0bfff",
      "fillStyle": "solid",
      "strokeWidth": 2,
      "roughness": 1,
      "opacity": 50,
      "roundness": { "type": 3 },
      "boundElements": [{ "id": "arr3", "type": "arrow" }]
    },
    {
      "id": "shard3-title",
      "type": "text",
      "x": 590,
      "y": 270,
      "width": 80,
      "height": 20,
      "text": "Shard 3",
      "fontSize": 14,
      "fontFamily": 4,
      "textAlign": "center",
      "strokeColor": "#7048e8"
    },
    {
      "id": "shard3-snap",
      "type": "text",
      "x": 570,
      "y": 295,
      "width": 120,
      "height": 18,
      "text": "Snapshot C",
      "fontSize": 12,
      "fontFamily": 4,
      "textAlign": "center",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard3-ind",
      "type": "text",
      "x": 575,
      "y": 315,
      "width": 110,
      "height": 16,
      "text": "(独立创建)",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "center",
      "strokeColor": "#495057"
    },
    {
      "id": "shard3-parts",
      "type": "text",
      "x": 560,
      "y": 345,
      "width": 60,
      "height": 18,
      "text": "Parts:",
      "fontSize": 11,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard3-p1",
      "type": "text",
      "x": 570,
      "y": 365,
      "width": 80,
      "height": 16,
      "text": "• Part 7",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard3-p2",
      "type": "text",
      "x": 570,
      "y": 383,
      "width": 80,
      "height": 16,
      "text": "• Part 8",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard3-p3",
      "type": "text",
      "x": 570,
      "y": 401,
      "width": 80,
      "height": 16,
      "text": "• Part 9",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#1e1e1e"
    },
    {
      "id": "shard3-diff",
      "type": "text",
      "x": 575,
      "y": 430,
      "width": 110,
      "height": 16,
      "text": "(数据不同)",
      "fontSize": 10,
      "fontFamily": 4,
      "textAlign": "center",
      "strokeColor": "#495057"
    },
    {
      "id": "note1",
      "type": "text",
      "x": 80,
      "y": 510,
      "width": 560,
      "height": 20,
      "text": "每个 Shard 的 __global_row_index 是基于本地 Snapshot 计算的",
      "fontSize": 12,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#495057"
    },
    {
      "id": "note2",
      "type": "text",
      "x": 80,
      "y": 535,
      "width": 600,
      "height": 20,
      "text": "不同 Shard 的 __global_row_index 不可比较（因为数据本身就不同）",
      "fontSize": 12,
      "fontFamily": 4,
      "textAlign": "left",
      "strokeColor": "#c92a2a"
    },
    {
      "id": "arr1",
      "type": "arrow",
      "x": 200,
      "y": 195,
      "width": 30,
      "height": 60,
      "points": [[0, 0], [-30, 60]],
      "strokeColor": "#1e1e1e",
      "strokeWidth": 2,
      "roughness": 1,
      "endArrowhead": "arrow",
      "startBinding": { "elementId": "coord-box", "focus": -0.5, "gap": 5 },
      "endBinding": { "elementId": "shard1-box", "focus": 0, "gap": 5 }
    },
    {
      "id": "arr2",
      "type": "arrow",
      "x": 400,
      "y": 195,
      "width": 0,
      "height": 60,
      "points": [[0, 0], [0, 60]],
      "strokeColor": "#1e1e1e",
      "strokeWidth": 2,
      "roughness": 1,
      "endArrowhead": "arrow",
      "startBinding": { "elementId": "coord-box", "focus": 0, "gap": 5 },
      "endBinding": { "elementId": "shard2-box", "focus": 0, "gap": 5 }
    },
    {
      "id": "arr3",
      "type": "arrow",
      "x": 600,
      "y": 195,
      "width": 30,
      "height": 60,
      "points": [[0, 0], [30, 60]],
      "strokeColor": "#1e1e1e",
      "strokeWidth": 2,
      "roughness": 1,
      "endArrowhead": "arrow",
      "startBinding": { "elementId": "coord-box", "focus": 0.5, "gap": 5 },
      "endBinding": { "elementId": "shard3-box", "focus": 0, "gap": 5 }
    }
  ],
  "appState": {
    "viewBackgroundColor": "#ffffff"
  },
  "files": {}
}
